direction: right

title: Reference Data {
  near: top-center
  shape: text
  style.font-size: 24
}

exchanges: Exchanges {
  kalshi: Kalshi API
}

cli: ssmd CLI {
  shape: rectangle
  style.fill: "#c8e6c9"
}

api: ssmd-data-ts {
  shape: rectangle
  style.fill: "#c8e6c9"
}

postgres: PostgreSQL {
  shape: cylinder
  style.fill: "#a5d6a7"
}

cdc: ssmd-cdc {
  shape: rectangle
  style.fill: "#c8e6c9"
}

nats: NATS JetStream {
  shape: cylinder
  style.fill: "#ffecb3"
}

cache: ssmd-cache {
  shape: rectangle
  style.fill: "#c8e6c9"
}

redis: Redis {
  shape: cylinder
  style.fill: "#ffcdd2"
}

admin: ssmd-admin {
  shape: rectangle
  style.fill: "#ede7f6"
}

# Sync flow
exchanges -> cli: REST API
cli -> api: HTTP API
api -> postgres: write

# CDC flow
postgres -> cdc: CDC stream
cdc -> nats: cdc.>

# Cache flow
nats -> cache: CDC events
cache -> redis: populate
cache -> postgres: warm from DB

# Read flow
api -> postgres: read
api -> redis: cache reads

# Admin
admin -> api: HTTP API
