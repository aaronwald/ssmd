direction: right

exchanges: Exchanges {
  kalshi: Kalshi WebSocket
}

capture: Data Capture {
  style.fill: "#fff3e0"
  connector: ssmd-connector {
    shape: rectangle
    style.fill: "#e3f2fd"
  }
  nats: NATS JetStream {
    shape: cylinder
    style.fill: "#ffecb3"
  }
  archiver: ssmd-archiver {
    shape: rectangle
    style.fill: "#e3f2fd"
  }

  connector -> nats: prod.kalshi.>
  nats -> archiver
}

refdata: Reference Data {
  style.fill: "#e8f5e9"
  shape: rectangle
}

runtime: Signal Runtime {
  style.fill: "#e1f5fe"
  runner: ssmd-signal-runner {
    shape: rectangle
    style.fill: "#b3e5fc"
  }
}

agent: Agent (ssmd-agent) {
  style.fill: "#f3e5f5"
}

admin: ssmd-admin {
  style.fill: "#ede7f6"
  shape: rectangle
}

operators: ssmd-operators {
  style.fill: "#e0f7fa"
  shape: hexagon
}

git: Git {
  shape: cylinder
  style.fill: "#ffebee"
}

exchanges -> capture
exchanges -> refdata: Kalshi API
capture.nats -> runtime.runner: subscribe
runtime.runner -> capture.nats: signals.*.fires
refdata -> agent: {style.stroke-dash: 3}
refdata -> capture.nats: cdc.> {style.stroke-dash: 3}
capture -> agent: {style.stroke-dash: 3}
agent -> git
admin -> refdata: HTTP API
operators -> capture: manages CRs {style.stroke-dash: 3}
