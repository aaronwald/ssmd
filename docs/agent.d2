direction: right

refdata: Reference Data {
  style.fill: "#e8f5e9"
  api: ssmd-data-ts
  postgres: PostgreSQL {
    shape: cylinder
  }
  api -> postgres
}

capture: Data Capture {
  style.fill: "#fff3e0"
  nats: NATS JetStream {
    shape: cylinder
  }
  archiver: ssmd-archiver
  nats -> archiver
}

agent: Agent (ssmd-agent) {
  style.fill: "#f3e5f5"

  prompts: Prompts {
    shape: oval
  }
  repl: LangGraph REPL

  tools: Tools {
    style.fill: "#e0f2f1"
    example: |md
      - get_events / get_markets
      - get_fee_schedule
      - run_backtest
    |
  }

  builders: State Builders {
    style.fill: "#fff8e1"
    example: |md
      - VolumeProfileBuilder
      - (more planned)
    |
  }

  prompts -> repl
  repl -> tools
  repl -> builders
}

signals: signals/*.ts {
  shape: document
  style.fill: "#f3e5f5"
}

refdata.api -> agent.tools: HTTP API
capture.nats -> agent.builders: {style.stroke-dash: 3}
agent -> signals: generates
