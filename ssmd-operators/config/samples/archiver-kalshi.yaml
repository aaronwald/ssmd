apiVersion: ssmd.ssmd.io/v1alpha1
kind: Archiver
metadata:
  name: kalshi-archiver
  namespace: ssmd
spec:
  date: "2026-01-06"
  image: ghcr.io/aaronwald/ssmd-archiver:0.4.8
  source:
    stream: PROD_KALSHI
    url: nats://nats.nats.svc.cluster.local:4222
    filter: "prod.kalshi.main.json.>"
  storage:
    local:
      path: /data/ssmd/kalshi
      pvcName: ssmd-archiver-data
    remote:
      type: gcs
      bucket: ssmd-archive
      prefix: kalshi
      secretRef: gcs-credentials
  rotation:
    maxFileAge: "15m"
  sync:
    enabled: true
  resources:
    requests:
      cpu: 100m
      memory: 128Mi
    limits:
      cpu: 500m
      memory: 512Mi
