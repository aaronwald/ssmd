apiVersion: ssmd.ssmd.io/v1alpha1
kind: Archiver
metadata:
  name: kalshi-archiver
  namespace: ssmd
spec:
  date: "2026-01-06"
  image: ghcr.io/aaronwald/ssmd-archiver:0.5.0
  feed: kalshi
  sources:
    - name: politics
      stream: PROD_KALSHI_POLITICS
      consumer: politics-archiver
      filter: "prod.kalshi.politics.json.>"
    - name: economics
      stream: PROD_KALSHI_ECONOMICS
      consumer: economics-archiver
      filter: "prod.kalshi.economics.json.>"
  storage:
    local:
      path: /data/ssmd
      pvcName: ssmd-archiver-data
    remote:
      type: gcs
      bucket: ssmd-archive
      prefix: kalshi
      secretRef: gcs-credentials
  rotation:
    maxFileAge: "15m"
  sync:
    enabled: true
    onDelete: final
  resources:
    requests:
      cpu: 100m
      memory: 128Mi
    limits:
      cpu: 500m
      memory: 512Mi
