apiVersion: ssmd.ssmd.io/v1alpha1
kind: Notifier
metadata:
  name: kalshi-alerts
  namespace: ssmd
spec:
  image: ghcr.io/aaronwald/ssmd-notifier:0.1.0
  source:
    subjects:
      - signals.kalshi.>
      - alerts.kalshi.>
    natsUrl: nats://nats.nats:4222
  destinations:
    - name: slack-trading
      type: slack
      config:
        channel: "#trading-alerts"
      secretRef:
        name: ssmd-slack-credentials
        tokenField: bot-token
      match:
        - field: signal
          operator: in
          value: "momentum,volatility"
        - field: severity
          operator: gte
          value: "high"
    - name: discord-general
      type: discord
      config:
        webhookUrl: "https://discord.com/api/webhooks/..."
      match:
        - field: type
          operator: eq
          value: "market-open"
  resources:
    requests:
      cpu: 50m
      memory: 64Mi
    limits:
      cpu: 200m
      memory: 128Mi
