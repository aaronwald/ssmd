name: kalshi
display_name: Kalshi Exchange
type: websocket
status: active
versions:
  - version: v1
    effective_from: "2025-12-22"
    protocol:
      transport: wss
      message: json
    endpoint: wss://api.elections.kalshi.com/trade-api/ws/v2
    auth_method: api_key
    rate_limit_per_second: 10

# Message types received from this exchange
message_types:
  ticker:
    identifier_field: market_ticker
    timestamp_field: ts
    timestamp_format: unix_seconds
    sequenced: false
    # Clock field exists but is global monotonic, not per-market sequential
  trade:
    identifier_field: market_ticker
    timestamp_field: ts
    timestamp_format: unix_seconds
    sequenced: true
    sequence_field: exchange_seq  # envelope `seq`, stored as exchange_seq in parquet
    sequence_scope: per_subscription  # scoped to sid, resets on reconnect
    sequence_group_by: sid  # DQ groups seq gaps by this column (not ticker)
  market_lifecycle_v2:
    identifier_field: market_ticker
    timestamp_field: _received_at
    timestamp_format: pipeline
    sequenced: false

# Component defaults for operators
defaults:
  connector:
    image: ghcr.io/aaronwald/ssmd-connector
    version: "0.4.7"
    resources:
      requests:
        cpu: 100m
        memory: 128Mi
      limits:
        cpu: 500m
        memory: 512Mi
    transport:
      type: nats
      stream: PROD_KALSHI
      subjectPrefix: prod.kalshi

  archiver:
    image: ghcr.io/aaronwald/ssmd-archiver
    version: "0.4.8"
    resources:
      requests:
        cpu: 100m
        memory: 256Mi
      limits:
        cpu: 500m
        memory: 512Mi
    rotation:
      interval: 15m

  signal:
    image: ghcr.io/aaronwald/ssmd-signal-runner
    version: "0.1.1"
    resources:
      requests:
        cpu: 100m
        memory: 128Mi
      limits:
        cpu: 500m
        memory: 512Mi
